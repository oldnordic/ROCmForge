---
phase: 20-code-hygiene-completion
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/ggml/hip_backend/ops/q4_k_dequant.rs
  - src/ggml/hip_backend/ops/q6_k_dequant.rs
  - src/ggml/hip_backend/ops/q4_0_dequant.rs
autonomous: true
user_setup: []

must_haves:
  truths:
    - "All type naming style warnings are eliminated"
    - "Type aliases follow upper camel case convention (no underscores after format prefix)"
    - "Privacy warning for Q4_0DequantCache resolved"
  artifacts:
    - path: "src/ggml/hip_backend/ops/q4_k_dequant.rs"
      provides: "Renamed types to Q4KdequantResult and Q4KdequantCache"
      contains: "pub type Q4KdequantResult"
    - path: "src/ggml/hip_backend/ops/q6_k_dequant.rs"
      provides: "Renamed types to Q6KdequantResult and Q6KdequantCache"
      contains: "pub type Q6KdequantResult"
    - path: "src/ggml/hip_backend/ops/q4_0_dequant.rs"
      provides: "Made Q4_0DequantCache pub or made fn private"
      contains: "pub struct Q4_0DequantCache or private fn"
  key_links:
    - from: "type definitions"
      to: "all usage sites"
      via: "find-replace across files"
      pattern: "Q4_KDequantResult|Q4_KDequantCache"
---

<objective>
Fix type naming style warnings and privacy mismatch.

Purpose: Q4_KDequantResult and Q6_KDequantCache violate Rust naming conventions (underscores in acronym sequences). Q4_0DequantCache has incorrect privacy relative to its accessor function.

Output: All types follow upper camel case, privacy matches usage.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="auto">
  <name>Rename Q4_K type aliases to follow naming conventions</name>
  <files>src/ggml/hip_backend/ops/q4_k_dequant.rs</files>
  <action>
    Rename type aliases following Rust naming conventions:
    - Q4_KDequantResult -> Q4KdequantResult (remove underscore after Q4)
    - Q4_KDequantCache -> Q4KdequantCache (remove underscore after Q4)

    Update all references in the same file:
    - Find: Q4_KDequantResult, Replace: Q4KdequantResult
    - Find: Q4_KDequantCache, Replace: Q4KdequantCache
    - Find: &'static Q4_KDequantCache, Replace: &'static Q4KdequantCache
    - Find: *const Q4_KDequantCache, Replace: *const Q4KdequantCache

    Also search for usages in other files:
    grep -r "Q4_KDequant" src/ --include="*.rs"
    Update any external references found.
  </action>
  <verify>grep -n "upper camel case.*Q4_K" &lt;(cargo check --features rocm 2>&1) returns no results</verify>
  <done>Q4KdequantResult and Q4KdequantCache used throughout</done>
</task>

<task type="auto">
  <name>Rename Q6_K type aliases to follow naming conventions</name>
  <files>src/ggml/hip_backend/ops/q6_k_dequant.rs</files>
  <action>
    Rename type aliases following Rust naming conventions:
    - Q6_KDequantResult -> Q6KdequantResult (remove underscore after Q6)
    - Q6_KDequantCache -> Q6KdequantCache (remove underscore after Q6)

    Update all references in the same file:
    - Find: Q6_KDequantResult, Replace: Q6KdequantResult
    - Find: Q6_KDequantCache, Replace: Q6KdequantCache
    - Find: &'static Q6_KDequantCache, Replace: &'static Q6KdequantCache
    - Find: *const Q6_KDequantCache, Replace: *const Q6KdequantCache

    Search for external usages:
    grep -r "Q6_KDequant" src/ --include="*.rs"
    Update any external references found.
  </action>
  <verify>grep -n "upper camel case.*Q6_K" &lt;(cargo check --features rocm 2>&1) returns no results</verify>
  <done>Q6KdequantResult and Q6KdequantCache used throughout</done>
</task>

<task type="auto">
  <name>Fix Q4_0DequantCache privacy mismatch</name>
  <files>src/ggml/hip_backend/ops/q4_0_dequant.rs</files>
  <action>
    Read src/ggml/hip_backend/ops/q4_0_dequant.rs around line 45.
    The warning says Q4_0DequantCache is more private than get_or_init_q4_0_dequant_cache.
    Two options:
    1. Make the struct pub (if it should be externally visible)
    2. Make the function private (if the struct is internal-only)

    Since this is a dequantization cache following the same pattern as Q4_K and Q6_K,
    and those cache structs have #[allow(dead_code)] on the module field,
    the struct should likely be pub to match the accessor function visibility.

    Change: `struct Q4_0DequantCache` to `pub struct Q4_0DequantCache`
  </action>
  <verify>grep -n "is more private" &lt;(cargo check --features rocm 2>&1) returns no results for Q4_0DequantCache</verify>
  <done>Q4_0DequantCache visibility matches accessor function</done>
</task>

<task type="auto">
  <name>Verify all naming and privacy warnings fixed</name>
  <files></files>
  <action>
    Run cargo check --features rocm.
    Verify no "upper camel case" warnings remain.
    Verify no "is more private" warnings remain.
    Count remaining warnings (should be 70, down from 74).
  </action>
  <verify>grep -E "upper camel case|is more private" &lt;(cargo check --features rocm 2>&1) | wc -l outputs 0</verify>
  <done>All type naming conventions followed</done>
</task>

</tasks>

<verification>
1. Read src/ggml/hip_backend/ops/q4_k_dequant.rs and confirm Q4KdequantResult and Q4KdequantCache
2. Read src/ggml/hip_backend/ops/q6_k_dequant.rs and confirm Q6KdequantResult and Q6KdequantCache
3. Read src/ggml/hip_backend/ops/q4_0_dequant.rs and confirm pub struct Q4_0DequantCache
4. Run cargo check --features rocm and verify no naming or privacy warnings
</verification>

<success_criteria>
- Zero "upper camel case" warnings (was 4, now 0)
- Zero "is more private" warnings (was 1, now 0)
- Total warning count reduced from 74 to 70
- All type aliases follow Rust naming conventions
</success_criteria>

<output>
After completion, create `.planning/phases/20-code-hygiene-completion/20-02-SUMMARY.md`
</output>
