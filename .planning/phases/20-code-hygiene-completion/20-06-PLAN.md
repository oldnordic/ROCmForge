---
phase: 20-code-hygiene-completion
plan: 06
type: execute
wave: 3
depends_on: ["20-04", "20-05"]
files_modified:
  - src/backend/hip_backend/backend.rs
  - src/ggml/hip_backend/mod.rs
  - src/loader/gguf.rs
  - src/model/execution_plan/execution_plan_src.rs
autonomous: true
user_setup: []

must_haves:
  truths:
    - "All remaining dead_code warnings are categorized"
    - "Unused fields are identified for review"
    - "Baseline for final cleanup established"
  artifacts:
    - path: "Dead code analysis output"
      provides: "Complete categorization of all dead code warnings"
      contains: "list by file and warning type"
  key_links:
    - from: "cargo check warnings"
      to: "categorized list"
      via: "warning parsing and categorization"
      pattern: "field.*is never read|method.*is never used|function.*is never used"
---

<objective>
Categorize all remaining dead code warnings and fix unused fields.

Purpose: First of three plans to resolve dead_code warnings. This plan categorizes all warnings and fixes unused fields in backend files.

Output: Complete categorization of warnings; unused fields resolved.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="auto">
  <name>Categorize all remaining dead code warnings</name>
  <files></files>
  <action>
    Run cargo check --features rocm and capture all warnings.
    Categorize by type:
    - field X is never read
    - method X is never used
    - function X is never used
    - constant X is never used
    - type alias X is never used
    - associated items X are never used

    Create a list of all affected files and line numbers.
    This will guide the systematic cleanup in this and subsequent plans.
  </action>
  <verify>Complete list of dead code warnings generated</verify>
  <done>All dead code warnings categorized by file and type</done>
</task>

<task type="auto">
  <name>Review and fix unused fields in backend files</name>
  <files>
    src/backend/hip_backend/backend.rs
    src/ggml/hip_backend/mod.rs
  </files>
  <action>
    For each "field X is never read" warning in backend files:
    1. Read the struct definition
    2. Search for any usage of the field with grep
    3. If truly unused:
       - If it's a placeholder for future work, add #[allow(dead_code)] with TODO comment
       - If it's obsolete, remove the field
    4. If used but compiler doesn't see it (e.g., FFI, macro), add #[allow(dead_code)] with justification

    Affected fields (from warning analysis):
    - module (multiple locations)
    - mqa_kv_replicate_module
    - qkt_matmul_module, softmax_module, weighted_matmul_module
    - qk_kernel, softmax_kernel, v_kernel
    - event, instant, head_size_bytes
  </action>
  <verify>grep "field.*is never read" &lt;(cargo check --features rocm 2>&1) | wc -l reduced or justified</verify>
  <done>All unused fields in backend files reviewed and handled</done>
</task>

</tasks>

<verification>
1. Run cargo check --features rocm and capture categorized warning list
2. Confirm all backend struct fields reviewed
3. Verify warning count reduced or justified with comments
</verification>

<success_criteria>
- Complete categorization of all dead code warnings
- All unused fields in backend files handled (removed or justified)
- Warning count baseline established for remaining cleanup
</success_criteria>

<output>
After completion, create `.planning/phases/20-code-hygiene-completion/20-06-SUMMARY.md`
</output>
